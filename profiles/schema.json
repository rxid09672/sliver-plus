{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/BishopFox/sliver/profiles/schema.json",
  "title": "Sliver Malleable C2 Profile Schema",
  "description": "Schema for validating Sliver Malleable C2 profiles",
  "type": "object",
  "required": ["profile"],
  "properties": {
    "profile": {
      "type": "object",
      "required": ["name", "version"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Profile name",
          "minLength": 1,
          "maxLength": 100
        },
        "author": {
          "type": "string",
          "description": "Profile author",
          "maxLength": 100
        },
        "description": {
          "type": "string",
          "description": "What this profile mimics",
          "maxLength": 500
        },
        "version": {
          "type": "string",
          "description": "Profile version (semver recommended)",
          "pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?$"
        },
        "http": {
          "type": "object",
          "description": "HTTP traffic customization",
          "properties": {
            "user_agents": {
              "type": "array",
              "description": "User-Agent strings (random selection)",
              "items": {
                "type": "string",
                "minLength": 1,
                "maxLength": 500
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "uris": {
              "type": "object",
              "description": "URI patterns for requests",
              "properties": {
                "get": {
                  "type": "array",
                  "description": "GET request URIs",
                  "items": {
                    "type": "string",
                    "pattern": "^/.*"
                  },
                  "minItems": 1
                },
                "post": {
                  "type": "array",
                  "description": "POST request URIs",
                  "items": {
                    "type": "string",
                    "pattern": "^/.*"
                  },
                  "minItems": 1
                }
              }
            },
            "headers": {
              "type": "object",
              "description": "HTTP headers (order preserved)",
              "properties": {
                "common": {
                  "type": "object",
                  "description": "Headers for all requests",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "get": {
                  "type": "object",
                  "description": "Additional headers for GET",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "post": {
                  "type": "object",
                  "description": "Additional headers for POST",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            },
            "server_headers": {
              "type": "object",
              "description": "Server response headers",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        },
        "tls": {
          "type": "object",
          "description": "TLS fingerprinting configuration",
          "properties": {
            "fingerprint": {
              "type": "string",
              "description": "Browser to mimic",
              "enum": ["chrome", "firefox", "ios", "android", "edge", "safari", "safari-ios", "safari-macos"]
            },
            "min_version": {
              "type": "string",
              "description": "Minimum TLS version",
              "enum": ["1.0", "1.1", "1.2", "1.3"]
            },
            "max_version": {
              "type": "string",
              "description": "Maximum TLS version",
              "enum": ["1.0", "1.1", "1.2", "1.3"]
            }
          }
        },
        "timing": {
          "type": "object",
          "description": "Callback timing configuration",
          "properties": {
            "interval": {
              "type": "integer",
              "description": "Base callback interval (seconds)",
              "minimum": 1,
              "maximum": 3600
            },
            "interval_variance": {
              "type": "integer",
              "description": "Random variance (seconds)",
              "minimum": 0,
              "maximum": 300
            },
            "jitter": {
              "type": "integer",
              "description": "Jitter percentage",
              "minimum": 0,
              "maximum": 99
            },
            "poll_timeout": {
              "type": "integer",
              "description": "Long poll timeout (seconds)",
              "minimum": 1,
              "maximum": 300
            }
          }
        },
        "metadata": {
          "type": "object",
          "description": "C2 metadata encoding",
          "properties": {
            "location": {
              "type": "string",
              "description": "Where to place metadata",
              "enum": ["header", "cookie", "uri-param", "uri-append", "body"]
            },
            "header_name": {
              "type": "string",
              "description": "Header name (if location=header)",
              "maxLength": 100
            },
            "cookie_name": {
              "type": "string",
              "description": "Cookie name (if location=cookie)",
              "maxLength": 100
            },
            "param_name": {
              "type": "string",
              "description": "URI param name (if location=uri-param)",
              "maxLength": 100
            },
            "encoding": {
              "type": "string",
              "description": "Encoding method",
              "enum": ["none", "base64", "hex", "netbios"]
            }
          },
          "dependencies": {
            "header_name": ["location"],
            "cookie_name": ["location"],
            "param_name": ["location"]
          }
        },
        "evasion": {
          "type": "object",
          "description": "Additional evasion techniques",
          "properties": {
            "traffic_masking": {
              "type": "object",
              "description": "Prepend legitimate content",
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "content_type": {
                  "type": "string",
                  "enum": ["javascript", "html", "css", "json", "xml"]
                },
                "min_size": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 1048576
                },
                "max_size": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 1048576
                }
              }
            }
          }
        }
      }
    }
  }
}

